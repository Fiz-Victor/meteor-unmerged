<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>OnlyRain233的小站</title>
  
  <subtitle>摸鱼中</subtitle>
  <link href="https://me.onlyra1n.top/atom.xml" rel="self"/>
  
  <link href="https://me.onlyra1n.top/"/>
  <updated>2023-07-25T08:35:26.252Z</updated>
  <id>https://me.onlyra1n.top/</id>
  
  <author>
    <name>OnlyRain233</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Cloudflare DNS 托管+Github Pages HTTPS加密避坑</title>
    <link href="https://me.onlyra1n.top/posts/a72ef3/"/>
    <id>https://me.onlyra1n.top/posts/a72ef3/</id>
    <published>2023-07-23T18:50:04.000Z</published>
    <updated>2023-07-25T08:35:26.252Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><p>如果要用Cloudflare给你gh pages做代理的话要先把gh的证书加上在开cloudflare的加速</p><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>最近在NameSilo上买了个自己的域名给托管到了Cloudflare上，准备当博客，开个自己的个人网站</p><p>博客部署完后，准备给自己的简介网站弄个域名，pages弄上去</p><p>就在Cloudflare上添加CNAME记录指向到我的<a href="https://fiz-victor.github.io/">Github Pages 域名</a>了</p><p>特别注意：我这时把CF的代理勾选了</p><h2 id="事发过程"><a href="#事发过程" class="headerlink" title="事发过程"></a>事发过程</h2><p>网站啥的都设置好了，发现没有https协议（）</p><p>奇怪了，gh pages上的dns check也过了，那个https勾选框灰了（恼）</p><p><code>Unavailable for your site because your domain is not properly configured to support HTTPS.</code></p><p>同时Cloudflare访问HTTPS的加密页面也会因为重定向次数过多而寄掉</p><p>解决方案：把SSL证书<code>灵活</code>换成<code>完全</code></p><p>之后，我尝试将CNAME记录改成A记录指向Github的IP，也一样报错</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@    A    185.199.108.153</span><br><span class="line">@    A    185.199.109.153</span><br><span class="line">@    A    185.199.110.153</span><br><span class="line">@    A    185.199.111.153</span><br></pre></td></tr></table></figure><p>后来查到cloudflare会自己把根域名下的cname转成a记录，就这样折腾了大半个小时就结果一无所获</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>这时我想起来之前配置博客弄https证书的时候成功在关闭代理的时候把gh的证书加上去了，我就开始怀疑是不是cloudflare代理的证书影响了gh证书检查的功能</p><p>我关闭我个人简介站点的加速之后发现gh pages已经开始获取证书了：</p><p><code>Unavailable for your site because a certificate has not yet been issued for your domain.</code></p><p>等了大概半分钟之后，原本变灰的按钮已经可以被选中了</p><p>开启之后简介网站已经可以强制https访问了</p><p>总结一下，Github和Cloudflare的加速就过不去，cf加速开了gh https的证书就死活套不上去，要把那个域名的cf加速给关掉才套得上去</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;TL-DR&quot;&gt;&lt;a href=&quot;#TL-DR&quot; class=&quot;headerlink&quot; title=&quot;TL;DR&quot;&gt;&lt;/a&gt;TL;DR&lt;/h2&gt;&lt;p&gt;如果要用Cloudflare给你gh pages做代理的话要先把gh的证书加上在开cloudflare的加速&lt;/p&gt;</summary>
      
    
    
    
    <category term="避坑" scheme="https://me.onlyra1n.top/categories/%E9%81%BF%E5%9D%91/"/>
    
    
    <category term="建站" scheme="https://me.onlyra1n.top/tags/%E5%BB%BA%E7%AB%99/"/>
    
    <category term="避坑" scheme="https://me.onlyra1n.top/tags/%E9%81%BF%E5%9D%91/"/>
    
    <category term="Github Pages" scheme="https://me.onlyra1n.top/tags/Github-Pages/"/>
    
    <category term="Cloudflare" scheme="https://me.onlyra1n.top/tags/Cloudflare/"/>
    
  </entry>
  
</feed>
